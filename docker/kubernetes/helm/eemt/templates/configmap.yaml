apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "eemt.fullname" . }}-config
  namespace: {{ .Release.Namespace | quote }}
  labels:
    {{- include "eemt.labels" . | nindent 4 }}
    app.kubernetes.io/component: configuration
data:
  # EEMT Algorithm Configuration
  eemt-linke-value: {{ .Values.config.eemt.linkeValue | quote }}
  eemt-albedo-value: {{ .Values.config.eemt.albedoValue | quote }}
  eemt-time-step: {{ .Values.config.eemt.timeStep | quote }}
  eemt-num-threads: {{ .Values.config.eemt.numThreads | quote }}
  
  # GRASS GIS Configuration
  grass-gisbase: {{ .Values.config.grass.gisbase | quote }}
  grass-addon-path: {{ .Values.config.grass.addon_path | quote }}
  
  # CCTools Configuration
  cctools-work-queue-port: {{ .Values.config.cctools.workQueuePort | quote }}
  cctools-project-name: {{ .Values.config.cctools.projectName | quote }}
  cctools-max-workers: {{ .Values.config.cctools.maxWorkers | quote }}
  
  # Deployment Configuration
  deployment-mode: {{ .Values.global.eemt.mode | quote }}
  resource-strategy: {{ .Values.global.resourceStrategy | quote }}
  
  # External Services Configuration
  {{- if .Values.external.daymet.enabled }}
  daymet-enabled: "true"
  daymet-base-url: {{ .Values.external.daymet.baseUrl | quote }}
  daymet-timeout: {{ .Values.external.daymet.timeout | quote }}
  {{- else }}
  daymet-enabled: "false"
  {{- end }}
  
  # Monitoring Configuration
  {{- if .Values.monitoring.prometheus.enabled }}
  prometheus-enabled: "true"
  prometheus-port: {{ .Values.monitoring.prometheus.port | quote }}
  prometheus-path: {{ .Values.monitoring.prometheus.path | quote }}
  {{- else }}
  prometheus-enabled: "false"
  {{- end }}
  
  logging-level: {{ .Values.monitoring.logging.level | quote }}
  logging-format: {{ .Values.monitoring.logging.format | quote }}
  
  # Development Configuration
  debug-mode: {{ .Values.development.debug | quote }}
  mock-services: {{ .Values.development.mockServices | quote }}
  reduced-resources: {{ .Values.development.reducedResources | quote }}
---
{{- if .Values.external.storage.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "eemt.fullname" . }}-storage-config
  namespace: {{ .Release.Namespace | quote }}
  labels:
    {{- include "eemt.labels" . | nindent 4 }}
    app.kubernetes.io/component: configuration
data:
  storage-type: {{ .Values.external.storage.type | quote }}
  storage-bucket: {{ .Values.external.storage.bucket | quote }}
  storage-region: {{ .Values.external.storage.region | quote }}
  storage-endpoint: {{ .Values.external.storage.endpoint | quote }}
{{- end }}